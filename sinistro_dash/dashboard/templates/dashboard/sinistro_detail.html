{% extends "dashboard/base.html" %}
{% block title %}Detalhe do Sinistro{% endblock %}

{% block content %}
<h3 class="mb-3">
  ðŸš¨ Sinistro em {{ sinistro.endereco }}
</h3>

<div class="row">
  <div class="col-md-6">
    <p><strong>Tipo:</strong> {{ sinistro.tipo_principal }}</p>
    <p><strong>Data:</strong> {{ sinistro.data_hora }}</p>
    <p><strong>VÃ­tima fatal:</strong> {{ sinistro.houve_vitima_fatal|yesno:"Sim,NÃ£o" }}</p>
  </div>

  <div class="col-md-6">
    <div id="map" style="height:300px" class="rounded shadow-sm"></div>
  </div>
</div>

<hr>

<h5>ðŸ‘¥ Envolvidos</h5>

{% for e in sinistro.envolvidos %}
<div class="card mb-2">
  <div class="card-body">
    <strong>{{ e.tipo|upper }}</strong>
  </div>
</div>
{% endfor %}

<hr>

<h5>ðŸ“¸ Fotos</h5>
<div class="row">
{% for f in sinistro.fotos %}
  <div class="col-md-3">
    <img src="{{ f.url }}" class="img-fluid rounded shadow-sm">
  </div>
{% endfor %}
</div>
{% endblock %}

{% block extra_js %}
<script>
const map = L.map('map').setView(
  [{{ sinistro.latitude }}, {{ sinistro.longitude }}],
  16
);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
L.marker([{{ sinistro.latitude }}, {{ sinistro.longitude }}]).addTo(map);
</script>
{% endblock %}
